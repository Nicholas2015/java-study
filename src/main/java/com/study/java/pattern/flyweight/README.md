## 享元模式

### 定义
享元模式（Flywight Pattern）又称轻量模式，是对象池的一种实现。类似于线程池，线程池可以避免不停的创建和销毁多个对象，消耗性能。提供了减少对象数量从而改善应用所需的对象结构的方式。

宗旨：共享细粒度对象，将多个对同一个对象的访问集中起来。

属于结构型模式。

### 场景
* 常常应用于系统底层的开发，以便解决系统的性能问题。
* 系统有大量相似对象、需要缓冲池的场景。

### 特点
将经常使用数据的缓存起来

### 优点
* 减少对象的创建，降低内存中对象的数量，降低系统内存的使用，提高效率
* 减少内存之外的其他资源的占用(比如TCP、数据库连接)

### 缺点
* 关注内、外部状态、关注线程安全问题
* 使系统、程序的逻辑复杂化（比如Integer在*128~127范围内判断100==100正常，判断1000=1000不正常）

### 拓展
* 内部状态：指对象共享的信息，存在享元对象内部并且不会随环境的改变而改变（比如[ConnectPool](./pool/ConnectionPool.java)中的username、password）
* 外部状态：指对象依赖的标记（比如这个对象有没有被回收），随着环境的改变而改变，不可共享的状态（比如[ConnectPool](./pool/ConnectionPool.java)中连接(Connection)）


### 源码应用
* Integer、Long、Short的valueOf

### 相关设计模式
* 享元模式和代理模式
  * 享元模式，控制不去反复的占用资源，一对多
  * 代理模式，静态代理一对一，功能增强
* 享元模式和单例模式
  * 享元模式，一般配合工厂模式使用，会有个享元工厂，大部分情况下会设置成单例